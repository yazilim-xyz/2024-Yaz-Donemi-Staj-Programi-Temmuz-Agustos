{"version":3,"file":"getVideoTrackConstraints.js","sources":["../../../../src/helpers/constraints/getVideoTrackConstraints.ts"],"sourcesContent":["import type { GetMainCameraParams } from '../getMainCamera';\r\nimport { getMainCamera } from '../getMainCamera';\r\n\r\nexport type VideoResolutionSize = {\r\n  width: number;\r\n  height: number;\r\n};\r\n\r\nexport type CameraResolutionType = 'HD' | 'FHD' | 'QHD' | 'UHD';\r\nexport type CameraResolutionMode = keyof ConstrainULongRange;\r\n\r\nexport const VIDEO_RESOLUTION_SIZE: Record<CameraResolutionType, VideoResolutionSize> = {\r\n  UHD: {\r\n    width: 3840,\r\n    height: 2160\r\n  },\r\n  QHD: {\r\n    width: 2560,\r\n    height: 1440\r\n  },\r\n  FHD: {\r\n    width: 1920,\r\n    height: 1080\r\n  },\r\n  HD: {\r\n    width: 1280,\r\n    height: 720\r\n  }\r\n};\r\n\r\nexport interface VideoTrackConstraintsOptions {\r\n  cameraResolutionMode?: CameraResolutionMode;\r\n  cameraResolutionType?: CameraResolutionType;\r\n  mainCamera?: GetMainCameraParams | boolean;\r\n  frontCamera?: boolean;\r\n}\r\n\r\n/**\r\n * Generates and returns video track constraints by passed options\r\n *\r\n * @param {GetMediaStreamConstraintsParams} options - options for constraints generating\r\n * @return {Promise<MediaStreamConstraints>} video track constraints\r\n */\r\nexport const getVideoTrackConstraints = async (\r\n  externalConstraints: MediaTrackConstraints,\r\n  {\r\n    mainCamera: useMainCamera,\r\n    frontCamera: useFrontCamera,\r\n    cameraResolutionType,\r\n    cameraResolutionMode = 'ideal'\r\n  }: VideoTrackConstraintsOptions\r\n) => {\r\n  const customConstraints: MediaTrackConstraints = {\r\n    ...(cameraResolutionType && {\r\n      width: {\r\n        [cameraResolutionMode]: VIDEO_RESOLUTION_SIZE[cameraResolutionType].width\r\n      },\r\n      height: {\r\n        [cameraResolutionMode]: VIDEO_RESOLUTION_SIZE[cameraResolutionType].height\r\n      }\r\n    })\r\n  };\r\n\r\n  if (useMainCamera) {\r\n    const mainCamera = await getMainCamera(\r\n      typeof useMainCamera === 'object' ? useMainCamera : undefined,\r\n      useFrontCamera\r\n    );\r\n\r\n    if (mainCamera?.deviceId) {\r\n      customConstraints.deviceId = { exact: mainCamera.deviceId };\r\n    }\r\n  }\r\n\r\n  if (!customConstraints.deviceId && typeof useFrontCamera === 'boolean') {\r\n    customConstraints.facingMode = useFrontCamera ? 'user' : 'environment';\r\n  }\r\n\r\n  const finalConstraints: MediaTrackConstraints = {\r\n    ...customConstraints,\r\n    ...externalConstraints\r\n  };\r\n\r\n  return finalConstraints;\r\n};\r\n"],"names":["VIDEO_RESOLUTION_SIZE","UHD","width","height","QHD","FHD","HD","getVideoTrackConstraints","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","externalConstraints","_ref","useMainCamera","useFrontCamera","cameraResolutionType","_ref$cameraResolution","cameraResolutionMode","customConstraints","mainCamera","finalConstraints","wrap","_context","prev","next","frontCamera","_objectSpread","_defineProperty","getMainCamera","_typeof","undefined","sent","deviceId","exact","facingMode","_objectSpread2","abrupt","stop","_x","_x2","apply","this","arguments"],"mappings":";2GAWaA,EAA2E,CACtFC,IAAK,CACHC,MAAO,KACPC,OAAQ,MAEVC,IAAK,CACHF,MAAO,KACPC,OAAQ,MAEVE,IAAK,CACHH,MAAO,KACPC,OAAQ,MAEVG,GAAI,CACFJ,MAAO,KACPC,OAAQ,MAiBCI,EAAwB,WAAA,IAAAC,EAAAC,EAAAA,kBAAAC,wBAAAC,MAAG,SAAAC,EACtCC,EAA0CC,GAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAZ,EAAAA,sBAAAa,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAgBvC,GAdWX,EAAaD,EAAzBO,WACaL,EAAcF,EAA3Ba,YACAV,EAAoBH,EAApBG,qBAAoBC,EAAAJ,EACpBK,qBAAAA,OAAuB,IAAHD,EAAG,QAAOA,EAG1BE,EAAwCQ,EAAAA,eACxCX,CAAAA,EAAAA,GAAwB,CAC1Bf,MAAK2B,EAAAA,gBAAA,GACFV,EAAuBnB,EAAsBiB,GAAsBf,OAEtEC,OAAM0B,EAAAA,gBAAA,GACHV,EAAuBnB,EAAsBiB,GAAsBd,WAKtEY,EAAa,CAAAS,EAAAE,KAAA,EAAA,KAAA,CAAA,OAAAF,EAAAE,KAAA,EACUI,EAAaA,cACX,WAAzBC,EAAAA,QAAOhB,GAA6BA,OAAgBiB,EACpDhB,GACD,KAAA,EAEGK,OALEA,EAAUG,EAAAS,OAKZZ,EAAYa,WACdd,EAAkBc,SAAW,CAAEC,MAAOd,EAAWa,WAClD,KAAA,EASqB,OANnBd,EAAkBc,UAAsC,kBAAnBlB,IACxCI,EAAkBgB,WAAapB,EAAiB,OAAS,eAGrDM,EAAuCM,EAAAS,eAAAT,EAAAS,eACxCjB,CAAAA,EAAAA,GACAP,GAAmBW,EAAAc,OAAA,SAGjBhB,GAAgB,KAAA,GAAA,IAAA,MAAA,OAAAE,EAAAe,OAAA,GAAA3B,EACxB,KAAA,OAAA,SAzCoC4B,EAAAC,GAAA,OAAAjC,EAAAkC,MAAAC,KAAAC,UAAA,CAAA,CAAA"}