{"version":3,"file":"index-022e8735.js","sources":["../../../core/dist/esm/helpers/snapshot/getVideoFrameCanvas.js","../../../core/dist/esm/helpers/snapshot/getWebcamSnapshot.js","../../src/components/Webcam/Webcam.tsx"],"sourcesContent":["/* @license @webcam/core v0.0.0 */\nimport{b as e}from\"../../_rollupPluginBabelHelpers-59ed2110.js\";var i=[\"imageSmoothingEnabled\",\"mirrored\"],t=function(t){var a,o,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=d.imageSmoothingEnabled,n=void 0===r||r,l=d.mirrored,h=e(d,i),g=t.videoWidth,m=t.videoHeight,v=document.createElement(\"canvas\");v.width=null!==(a=h.width)&&void 0!==a?a:g,v.height=null!==(o=h.height)&&void 0!==o?o:m;var s=v.getContext(\"2d\");if(s)return l&&(s.translate(v.width,0),s.scale(-1,1)),s.imageSmoothingEnabled=n,s.drawImage(t,0,0,v.width,v.height),l&&(s.scale(-1,1),s.translate(-v.width,0)),v};export{t as getVideoFrameCanvas};\n//# sourceMappingURL=getVideoFrameCanvas.js.map\n","/* @license @webcam/core v0.0.0 */\nimport{getVideoFrameCanvas as a}from\"./getVideoFrameCanvas.js\";import{b as o}from\"../../_rollupPluginBabelHelpers-59ed2110.js\";var r=[\"format\",\"quality\"],t=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=i.format,l=void 0===e?\"image/jpeg\":e,m=i.quality,f=void 0===m?1:m,n=o(i,r),p=a(t,n);if(p)return p.toDataURL(l,f)};export{t as getWebcamSnapshot};\n//# sourceMappingURL=getWebcamSnapshot.js.map\n","import type { ComponentPropsWithoutRef, FC, ReactNode, RefObject, SyntheticEvent } from 'react';\r\nimport React, { useEffect, useRef } from 'react';\r\nimport type { GetVideoFrameCanvasOptions, GetWebcamSnapshotOptions } from '@webcam/core';\r\nimport { getVideoFrameCanvas, getWebcamSnapshot } from '@webcam/core';\r\n\r\nimport type { UseMediaStreamParams } from '@/utils/hooks';\r\n\r\nimport { useWebcam } from './hooks';\r\n\r\ntype VideoElementProps = Omit<ComponentPropsWithoutRef<'video'>, 'children'>;\r\ntype AvailableUseMediaStreamParams = Omit<UseMediaStreamParams, 'disable'>;\r\n\r\nexport type WebcamRenderProps = (options: {\r\n  getCanvas: (options?: GetVideoFrameCanvasOptions) => HTMLCanvasElement | undefined;\r\n  getSnapshot: (options?: GetWebcamSnapshotOptions) => string | undefined;\r\n  videoElement: HTMLVideoElement | null;\r\n}) => ReactNode;\r\n\r\ninterface BaseWebcamProps extends VideoElementProps {\r\n  children?: ReactNode | WebcamRenderProps;\r\n  innerRef?: RefObject<HTMLVideoElement>;\r\n  mirrored?: boolean;\r\n}\r\n\r\ninterface WebcamPropsWithInternalStream extends BaseWebcamProps, AvailableUseMediaStreamParams {\r\n  stream?: undefined;\r\n}\r\n\r\ninterface WebcamPropsWithExternalStream extends BaseWebcamProps {\r\n  stream?: MediaStream;\r\n}\r\n\r\ntype WebcamPropsEnumeration = WebcamPropsWithExternalStream &\r\n  Omit<WebcamPropsWithInternalStream, 'stream'>;\r\n\r\nexport type WebcamProps = WebcamPropsWithInternalStream | WebcamPropsWithExternalStream;\r\n\r\n/**\r\n * Renders the Webcam component and handles the requesting and displaying of the media stream\r\n *\r\n * @param {WebcamProps} props - The props for the Webcam component\r\n * @return {ReactElement} The rendered Webcam component\r\n */\r\nexport const Webcam: FC<WebcamProps> = ({\r\n  innerRef: externalVideoRef,\r\n  stream: externalStream,\r\n  cameraResolutionMode,\r\n  cameraResolutionType,\r\n  videoConstraints,\r\n  audioConstraints,\r\n  requestTimeLimit,\r\n  applyConstraints,\r\n  frontCamera,\r\n  mainCamera,\r\n  mirrored = true,\r\n  muted = true,\r\n  style = {},\r\n  children,\r\n  onLoadedMetadata,\r\n  onStreamRequest,\r\n  onStreamError,\r\n  onStreamStart,\r\n  onStreamStop,\r\n  ...props\r\n}: WebcamPropsEnumeration) => {\r\n  const internalVideoRef = useRef<HTMLVideoElement | null>(null);\r\n  const videoRef = externalVideoRef ?? internalVideoRef;\r\n\r\n  const onMediaStreamLoad = (event: SyntheticEvent<HTMLVideoElement, Event>) => {\r\n    onLoadedMetadata?.(event);\r\n    event.currentTarget.play();\r\n  };\r\n\r\n  const stream = useWebcam(\r\n    videoRef,\r\n    !externalStream\r\n      ? {\r\n          // STREAM PARAMS:\r\n          applyConstraints,\r\n          requestTimeLimit,\r\n          // STREAM HANDLERS:\r\n          onStreamRequest,\r\n          onStreamError,\r\n          onStreamStart,\r\n          onStreamStop,\r\n          // DEFAULT CONSTRAINTS:\r\n          videoConstraints,\r\n          audioConstraints,\r\n          // CUSTOM CONSTRAINTS:\r\n          cameraResolutionMode,\r\n          cameraResolutionType,\r\n          frontCamera,\r\n          mainCamera,\r\n          muted\r\n        }\r\n      : {\r\n          disable: true\r\n        }\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!externalStream) return;\r\n\r\n    stream.start(externalStream);\r\n\r\n    return () => {\r\n      stream.stop(externalStream);\r\n    };\r\n  }, [externalStream]);\r\n\r\n  return (\r\n    <>\r\n      <video\r\n        autoPlay\r\n        playsInline\r\n        muted={muted}\r\n        ref={videoRef}\r\n        controls={false}\r\n        src={stream.source}\r\n        onLoadedMetadata={onMediaStreamLoad}\r\n        style={{\r\n          ...style,\r\n          ...(mirrored && {\r\n            transform: `${style.transform ? `${style.transform} ` : ''}scaleX(-1)`\r\n          })\r\n        }}\r\n        {...props}\r\n      />\r\n      {typeof children === 'function'\r\n        ? children({\r\n            videoElement: videoRef.current,\r\n            getCanvas: (options?: GetVideoFrameCanvasOptions) =>\r\n              videoRef.current\r\n                ? getVideoFrameCanvas(videoRef.current, { ...options, mirrored })\r\n                : undefined,\r\n            getSnapshot: (options?: GetWebcamSnapshotOptions) =>\r\n              videoRef.current\r\n                ? getWebcamSnapshot(videoRef.current, { ...options, mirrored })\r\n                : undefined\r\n          })\r\n        : children}\r\n    </>\r\n  );\r\n};\r\n"],"names":["t","a","o","d","arguments","length","r","imageSmoothingEnabled","n","l","mirrored","h","e","i","g","videoWidth","m","videoHeight","v","document","createElement","width","height","s","getContext","translate","scale","drawImage","format","quality","f","p","toDataURL","Webcam","_ref","externalVideoRef","innerRef","externalStream","stream","cameraResolutionMode","cameraResolutionType","videoConstraints","audioConstraints","requestTimeLimit","applyConstraints","frontCamera","mainCamera","_ref$mirrored","_ref$muted","muted","_ref$style","style","children","onLoadedMetadata","onStreamRequest","onStreamError","onStreamStart","onStreamStop","props","_objectWithoutProperties","_excluded","internalVideoRef","useRef","videoRef","useWebcam","disable","useEffect","start","stop","React","Fragment","_extends","autoPlay","playsInline","ref","controls","src","source","event","currentTarget","play","_objectSpread","transform","concat","videoElement","current","getCanvas","options","getVideoFrameCanvas","undefined","getSnapshot","getWebcamSnapshot"],"mappings":"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"}