{"version":3,"file":"useAnimationFrame.js","sources":["../../../../src/utils/hooks/useAnimationFrame.ts"],"sourcesContent":["import { useEffect, useRef } from 'react';\r\n\r\nimport { cancelAnimationFrame, requestAnimationFrame } from '../helpers';\r\n\r\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\r\n\r\n/**\r\n * Helps request and cancel animation frame\r\n *\r\n * @param {Function} callback - frame request callback\r\n * @param {boolean} active - should animation frame be requested\r\n * @return {Object} request/cancel animation frame handlers\r\n */\r\nexport const useAnimationFrame = (callback: (time: number) => void, active?: boolean) => {\r\n  const animationFrameRequestRef = useRef<number>();\r\n  const previousTimestampRef = useRef<number>();\r\n  const savedHandlerRef = useRef(callback);\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    savedHandlerRef.current = callback;\r\n  }, [callback]);\r\n\r\n  const onFrameRequest = (timestamp?: DOMHighResTimeStamp) => {\r\n    if (timestamp) {\r\n      previousTimestampRef.current = timestamp;\r\n      if (typeof previousTimestampRef.current === 'undefined') return;\r\n      savedHandlerRef.current(timestamp - previousTimestampRef.current);\r\n    }\r\n\r\n    animationFrameRequestRef.current = requestAnimationFrame(onFrameRequest);\r\n  };\r\n\r\n  const onFrameCancel = () => {\r\n    if (!animationFrameRequestRef.current) return;\r\n    cancelAnimationFrame(animationFrameRequestRef.current);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (active) {\r\n      animationFrameRequestRef.current = requestAnimationFrame(onFrameRequest);\r\n      return;\r\n    }\r\n\r\n    onFrameCancel();\r\n    return () => onFrameCancel();\r\n  }, [active]);\r\n\r\n  return {\r\n    request: onFrameRequest,\r\n    cancel: onFrameCancel\r\n  };\r\n};\r\n"],"names":["useAnimationFrame","callback","active","animationFrameRequestRef","useRef","previousTimestampRef","savedHandlerRef","useIsomorphicLayoutEffect","current","onFrameRequest","timestamp","requestAnimationFrame","onFrameCancel","cancelAnimationFrame","useEffect","request","cancel"],"mappings":";wNAaO,IAAMA,EAAoB,SAACC,EAAkCC,GAClE,IAAMC,EAA2BC,IAC3BC,EAAuBD,IACvBE,EAAkBF,EAAOH,GAE/BM,GAA0B,WACxBD,EAAgBE,QAAUP,CAC5B,GAAG,CAACA,IAEJ,IAAMQ,EAAiB,SAAjBA,EAAkBC,GACtB,GAAIA,EAAW,CAEb,GADAL,EAAqBG,QAAUE,OACa,IAAjCL,EAAqBG,QAAyB,OACzDF,EAAgBE,QAAQE,EAAYL,EAAqBG,QAC3D,CAEAL,EAAyBK,QAAUG,EAAsBF,IAGrDG,EAAgB,WACfT,EAAyBK,SAC9BK,EAAqBV,EAAyBK,UAahD,OAVAM,GAAU,WACR,IAAIZ,EAMJ,OADAU,IACO,WAAA,OAAMA,GAAe,EAL1BT,EAAyBK,QAAUG,EAAsBF,EAM7D,GAAG,CAACP,IAEG,CACLa,QAASN,EACTO,OAAQJ,EAEZ"}